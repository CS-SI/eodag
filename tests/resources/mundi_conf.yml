!provider
  name: mundi
  search: !plugin
    type: QueryStringSearch
    api_endpoint: 'https://{_collection}.browse.catalog.mundiwebservices.com/opensearch'
    need_auth: false
    result_type: 'xml'
    results_entry: '//ns:entry'
    literal_search_params:
        format: atom
        relation: intersects
    pagination:
        next_page_url_tpl: '{url}?{search}&maxRecords={items_per_page}&startIndex={skip}'
        start_page: 1
        total_items_nb_key_path: '//os:totalResults/text()'
        max_items_per_page: 50
    discover_metadata:
        auto_discovery: true
        metadata_pattern: '^(?!collection)[a-zA-Z0-9]+$'
        search_param: '{metadata}={{{metadata}}}'
        metadata_path: '*'
    metadata_mapping:
        product:type:
            - 'productType'
            - 'eo:productType/text()'
        processing:level:
            - 'processingLevel'
            - 'eo:processingLevel/text()'
        title: 'ns:title/text()'
        start_datetime:
            - 'timeStart={start_datetime#to_iso_utc_datetime}'
            - 'DIAS:sensingStartDate/text()'
        end_datetime:
            - 'timeEnd={end_datetime#to_iso_utc_datetime}'
            - 'DIAS:sensingStopDate/text()'
        id:
            - 'uid={id#remove_extension}'
            - 'dc:identifier/text()'
        grid:code:
            - 'tileIdentifier'
            - 'DIAS:tileIdentifier/text()'
        geometry:
            - 'geometry={geometry#to_rounded_wkt}'
            - '{georss:polygon|georss:where#from_georss}'
  products:
    S1_SAR_GRD:
        product:type: GRD
        _collection: Sentinel1
        metadata_mapping:
            eo:cloud_cover: 'null/text()'
    S1_SAR_SLC:
        product:type: SLC
        _collection: Sentinel1
        metadata_mapping:
            eo:cloud_cover: 'null/text()'
    S2_MSI_L1C:
        product:type: IMAGE
        processing:level: L1C
        _collection: Sentinel2
    GENERIC_COLLECTION:
        product:type: '{product:type}'
        _collection: '{collection}'
        instrument: '{instrument}'
        processing:level: '{processing:level}'
  auth: !plugin
    type: HTTPHeaderAuth
    headers:
        Cookie: "seeedtoken={apikey}"
